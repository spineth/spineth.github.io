!function(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";function n(e,t){return t?e.querySelector(t):document.querySelector(e)}function i(e,t){return t?e.querySelectorAll(t):document.querySelectorAll(e)}function s(e,...t){e.apply(this,t)}function r(e){return new Promise((function(t,a){e((function(e,n){e?a(e):t(n)}))}))}function o(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))}a.r(t);class c{constructor(){this.network=null,this.node=null,this.latestBlock=null,this.currentAccount=null,this.listeners=[],this.networkNames={1:"Main",3:"Ropsten",4:"Rinkeby",42:"Kovan"},this.updateInfo()}async updateInfo(){for(;;){var e=this.network,t=this.node,a=this.latestBlock,n=this.currentAccount,i=this.currentBalance;this.network=await this.retrieveNetwork(),this.node=await this.retrieveNode(),this.latestBlock=await this.retrieveBlockNumber(),this.currentAccount=await this.retrieveCurrentAccount(),this.currentAccount&&(this.currentBalance=await this.retrieveCurrentAccountBalance(),this.currentBalance=this.currentBalance.toString(10));var s=[];this.network!==e&&s.push("network"),this.node!==t&&s.push("node"),this.latestBlock!==a&&s.push("latestBlock"),this.currentAccount!==n&&s.push("currentAccount"),this.currentBalance!==i&&s.push("currentBalance"),s.length>0&&this.notifyPropertyChanges(s),await o(1e3)}}getNetworkName(e){var t=this.networkNames[e];return t||"Private"}getEtherscanURL(){return function(e){return e&&"Main"!==e?e+=".":e="","https://"+e+"etherscan.io"}(this.getCurrentNetworkName())}getCurrentNetworkName(){return this.getNetworkName(this.network)}getCurrentBalanceEth(){return window.web3.fromWei(this.currentBalance,"ether")}async waitForChange(e){var t=this;return await r((function(a){t.listeners.push({waitProperties:e,cb:a})}))}notifyPropertyChanges(e){for(var t,a=[],n=function(t){return e.indexOf(t)>=0},i=0;i<this.listeners.length;++i){var s=this.listeners[i],r=!1;s.waitProperties?s.waitProperties.find(n)&&(r=!0):r=!0,r&&((t=this.listeners)[i]=t[t.length-1],t.pop(),--i,a.push(s.cb))}for(i=0;i<a.length;++i){(0,a[i])()}}async waitForTransaction(e){for(;;){await this.waitForChange(["latestBlock"]);var t=await r((function(t){window.web3.eth.getTransaction(e,t)}));if(t&&t.blockNumber){var a=await r((function(t){window.web3.eth.getTransactionReceipt(e,t)}));if(!a.status)throw"Transaction completed, but status unknown";if(0===parseInt(a.status))throw"Transaction failed, may have run out of gas";break}}}async retrieveNode(){return await r((function(e){window.web3.version.getNode(e)}))}async retrieveNetwork(){return await r((function(e){window.web3.version.getNetwork(e)}))}async retrieveNode(){return await r((function(e){window.web3.version.getNode(e)}))}async retrieveBlockNumber(){return await r((function(e){window.web3.eth.getBlockNumber(e)}))}async retrieveCurrentAccount(){return await r((function(e){window.web3.eth.getAccounts((function(t,a){e(t,a[0])}))}))}async retrieveCurrentAccountBalance(){var e=this;return await r((function(t){window.web3.eth.getBalance(e.currentAccount,t)}))}}var l=new class{constructor(){this.enabled=!1}};class h{constructor(e){switch(this.address=null,this.contract=null,this.blockCreated=null,this.abi=[{constant:!1,inputs:[{name:"newAuthority",type:"address"}],name:"changeAuthority",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"minBetWei",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"WHEEL_SIZE",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"gameId",type:"uint256"}],name:"calculateEarnings",outputs:[{name:"feeWei",type:"uint256"},{name:"weiPlayer1",type:"uint256"},{name:"weiPlayer2",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"gameContext",outputs:[{name:"player1",type:"address"},{name:"player2",type:"address"},{name:"betAmountInWei",type:"uint256"},{name:"wheelBetPlayer1",type:"uint256"},{name:"wheelBetPlayer2",type:"uint256"},{name:"wheelResult",type:"uint256"},{name:"expireTime",type:"uint256"},{name:"state",type:"uint8"},{name:"withdrawnPlayer1",type:"bool"},{name:"withdrawnPlayer2",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"maxRevealSeconds",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"minBet",type:"uint256"},{name:"maxBet",type:"uint256"}],name:"changeBetLimits",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"player",type:"address"}],name:"getNextGameId",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"gameId",type:"uint256"},{name:"wheelPositionHash",type:"uint256"}],name:"createGame",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!1,inputs:[{name:"gameId",type:"uint256"}],name:"expireGame",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"gameId",type:"uint256"}],name:"cancelGame",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"gameId",type:"uint256"}],name:"withdrawEarnings",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"WIN_PERCENT_PER_DISTANCE",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"},{name:"",type:"uint256"}],name:"playerCompleteGames",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"gameId",type:"uint256"},{name:"playerSecret",type:"uint256"}],name:"revealBet",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"gameId",type:"uint256"},{name:"wheelBet",type:"uint256"}],name:"joinGame",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[],name:"authority",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"},{name:"",type:"uint256"}],name:"playerActiveGames",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"FEE_PERCENT",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"gameId",type:"uint256"},{name:"wheelBet",type:"uint256"},{name:"playerSecret",type:"uint256"}],name:"createWheelBetHash",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"openGames",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"maxBetWei",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"gameId",type:"uint256"},{indexed:!0,name:"player",type:"address"},{indexed:!0,name:"eventType",type:"uint8"}],name:"GameEvent",type:"event"}],this.WAITING_FOR_PLAYERS=0,this.WAITING_FOR_REVEAL=1,this.COMPLETE=2,this.EVENT_CREATE=0,this.EVENT_CANCEL=1,this.EVENT_JOIN=2,this.EVENT_REVEAL=3,this.EVENT_EXPIRE=4,this.EVENT_COMPLETE=5,this.EVENT_WITHDRAW=6,this.EVENT_START_REVEAL=7,this.GAME_ADDED=0,this.GAME_REMOVED=1,this.GAME_UPDATED=2,this.TOPIC_EVENTADDRESS=0,this.TOPIC_GAMEID=1,this.TOPIC_PLAYER=2,this.TOPIC_TYPE=3,this.stateNames={0:"WaitingForPlayers",1:"WaitingForReveal",2:"Complete"},e){case"18":l.enabled&&(this.address="0x86FaCf4c5b0C28B34C24c92Ba2A12ac888Db6299",this.blockCreated="0");break;case"1":this.address="0xee44B11148486c05112d6418b987D8B8C2632E8f",this.blockCreated="4780594";break;case"4":this.address="0xFaF98930E9ABd5676fD373186D1e37D545Fd9246",this.blockCreated="1448458";break;case"42":this.address="0xB7C6E6023f919060B8Cfb70BBB06DCF7aFDAEfB4",this.blockCreated="5128436"}if(null!=this.address){this.contract=window.web3.eth.contract(this.abi).at(this.address);for(var t=0;t<this.abi.length;++t){if("function"!==this.abi[t].type)continue;var a=this.abi[t].name;let e=this.abi[t].outputs;this.extendContractMethod(a,e)}}}isValid(){return null!==this.contract}extendContractMethod(e,t){this.contract[e].mapReturn=function(e){if(e.length!==t.length)throw"Mismatched array lengths";for(var a={},n=0;n<t.length;++n)a[t[n].name]=e[n];return a}}getGameColor(e){for(var t="#",a=0;a<6;++a){var n=e.charAt(e.length-1-a),i=parseInt(n,16);t+="0123456789ABCDEF".charAt(8+i%7)}return t}async retrieveBetLimits(){var e=this,t={};return t.min=await r((function(t){e.contract.minBetWei(t)})),t.min=window.web3.fromWei(t.min,"ether"),t.min=t.min.toString(10),t.max=await r((function(t){e.contract.maxBetWei(t)})),t.max=window.web3.fromWei(t.max,"ether"),t.max=t.max.toString(10),t}async retrieveGame(e){var t=this,a=await r((function(a){t.contract.gameContext(e,a)}));(a=t.contract.gameContext.mapReturn(a)).betAmountInEth=window.web3.fromWei(a.betAmountInWei,"ether"),a.gameId=e;var n=window.web3.sha3(e);return a.gameColor=t.getGameColor(n),a.state.toNumber()===t.COMPLETE&&(a.outcome=await r((function(a){t.contract.calculateEarnings(e,a)})),a.outcome=t.contract.calculateEarnings.mapReturn(a.outcome),a.outcome.ethPlayer1=window.web3.fromWei(a.outcome.weiPlayer1,"ether"),a.outcome.ethPlayer2=window.web3.fromWei(a.outcome.weiPlayer2,"ether"),a.outcome.feeEth=window.web3.fromWei(a.outcome.feeWei,"ether")),a}async retrieveOpenGames(e){for(var t=this,a=0;;++a){var n=await r((function(e){t.contract.openGames(a,e)}));if("0"===(n=n.toString(10)))break;if(!e(await t.retrieveGame(n)))break}}watchOpenGames(e,t){var a=this,n={active:!0,listener:async function(e){if(e.eventType===a.EVENT_CREATE){var i=await a.retrieveGame(e.gameId);n.active&&t(a.GAME_ADDED,i.gameId,i)}else e.eventType!==a.EVENT_JOIN&&e.eventType!==a.EVENT_CANCEL||n.active&&t(a.GAME_REMOVED,e.gameId)}};return this.retrieveOpenGames((function(e){return!!n.active&&(t(a.GAME_ADDED,e.gameId,e),!0)})).then((function(){n.active&&a.addGameEventListener({},e,n.listener)})),n}async retrieveActiveGames(e,t){var a=this;if(e)for(var n=0;;++n){var i=await r((function(t){a.contract.playerActiveGames(e,n,t)}));if("0"===(i=i.toString(10)))break;if(!t(await a.retrieveGame(i)))break}}watchActiveGames(e,t,a){var n=this,i={};if(e)return i.active=!0,i.listener=async function(e){if(e.eventType===n.EVENT_CREATE||e.eventType===n.EVENT_JOIN){var t=await n.retrieveGame(e.gameId);i.active&&a(n.GAME_ADDED,t.gameId,t)}else if(e.eventType===n.EVENT_CANCEL||e.eventType===n.EVENT_WITHDRAW)i.active&&a(n.GAME_REMOVED,e.gameId);else{t=await n.retrieveGame(e.gameId);i.active&&a(n.GAME_UPDATED,t.gameId,t)}},this.retrieveActiveGames(e,(function(e){return!!i.active&&(a(n.GAME_ADDED,e.gameId,e),!0)})).then((function(){i.active&&n.addGameEventListener({player:e},t,i.listener)})),i}async retrieveCompletedGames(e,t){var a=this;if(e)for(var n=0;;++n){var i=await r((function(t){a.contract.playerCompleteGames(e,n,t)}));if("0"===(i=i.toString(10)))break;if(!t(await a.retrieveGame(i)))break}}watchCompletedGames(e,t,a){var n=this,i={};if(e)return i.active=!0,i.listener=async function(e){if(e.eventType===n.EVENT_WITHDRAW){var t=await n.retrieveGame(e.gameId);i.active&&a(n.GAME_ADDED,t.gameId,t)}},this.retrieveCompletedGames(e,(function(e){return!!i.active&&(a(n.GAME_ADDED,e.gameId,e),!0)})).then((function(){i.active&&n.addGameEventListener({player:e,eventType:n.EVENT_WITHDRAW},t,i.listener)})),i}watchRecentGames(e,t){var a=this,n={active:!0,gameIdList:{},listener:async function(e){if(e.eventType===a.EVENT_COMPLETE||e.eventType===a.EVENT_EXPIRE){var i=await a.retrieveGame(e.gameId);n.active&&(n.gameIdList[e.gameId]||(n.gameIdList[e.gameId]=!0,t(a.GAME_ADDED,i.gameId,i)))}}};return a.addGameEventListener({eventType:[a.EVENT_COMPLETE,a.EVENT_EXPIRE]},e,n.listener),n}async createGame(e,t,a,n){var i=this,s=window.web3.toWei(t,"ether"),o=await r((function(t){i.contract.getNextGameId(e,t)}));o=o.toString(10);var c="";try{var l=window.web3.sha3(window.web3.toHex("Signing Spineth Game ID: "+o));c=await r((function(t){window.web3.eth.sign(e,l,t)}))}catch(e){if("authentication needed: password or unlock"!=e.message)throw e;c=await n()}c=window.web3.sha3(c+o,{encoding:"hex"});var h=await r((function(e){i.contract.createWheelBetHash(o,a,c,e)}));h=h.toString(10);var u=await r((function(t){i.contract.createGame.estimateGas(o,h,{from:e,value:s},t)}));return await r((function(t){i.contract.createGame(o,h,{from:e,value:s,gas:u},t)}))}async cancelGame(e,t){var a=this,n=await r((function(n){a.contract.cancelGame.estimateGas(t,{from:e,value:0},n)}));return await r((function(i){a.contract.cancelGame(t,{from:e,value:0,gas:n},i)}))}async joinGame(e,t,a){var n=this,i=await r((function(e){n.contract.gameContext(t,e)}));i=(i=n.contract.gameContext.mapReturn(i)).betAmountInWei.toString(10);var s=await r((function(s){n.contract.joinGame.estimateGas(t,a,{from:e,value:i},s)}));return await r((function(r){n.contract.joinGame(t,a,{from:e,value:i,gas:s},r)}))}async expireGame(e,t){var a=this,n=await r((function(n){a.contract.expireGame.estimateGas(t,{from:e,value:0},n)}));return r((function(i){a.contract.expireGame(t,{from:e,value:0,gas:n},i)}))}async revealBet(e,t,a){var n=this,i="";try{var s=window.web3.sha3(window.web3.toHex("Signing Spineth Game ID: "+t));i=await r((function(t){window.web3.eth.sign(e,s,t)}))}catch(e){if("authentication needed: password or unlock"!=e.message)throw e;i=await a()}i=window.web3.sha3(i+t,{encoding:"hex"});var o=await r((function(a){n.contract.revealBet.estimateGas(t,i,{from:e,value:0},a)}));return await r((function(a){n.contract.revealBet(t,i,{from:e,value:0,gas:o},a)}))}async withdrawEarnings(e,t){var a=this,n=await r((function(n){a.contract.withdrawEarnings.estimateGas(t,{from:e,value:0},n)}));return await r((function(i){a.contract.withdrawEarnings(t,{from:e,value:0,gas:n},i)}))}addGameEventListener(e,t,a){var n=this;this.removeGameEventListener(a);var i=n.contract.GameEvent(e),s=window.web3.eth.filter({address:n.contract.address.toLowerCase(),fromBlock:t,toBlock:"latest",topics:i.options.topics});a.gameEventFilter=s,a.gameEventListenerIds={},s.watch((function(e,i){if(!e){if(0!=i.blockNumber&&i.blockNumber<t)return;i.args={},i.args.gameId=window.web3.toBigNumber(i.topics[n.TOPIC_GAMEID]).toString(10),i.args.player=window.web3.toBigNumber(i.topics[n.TOPIC_PLAYER]).toString(10),i.args.eventType=parseInt(i.topics[n.TOPIC_TYPE]);var s=i.args.gameId+i.args.player+i.args.eventType;if(a.gameEventListenerIds[s])return;a.gameEventListenerIds[s]=!0,a(i.args)}}))}removeGameEventListener(e){e&&e.gameEventFilter&&(e.gameEventFilter.stopWatching((function(){})),delete e.gameEventFilter,delete e.gameEventListenerIds)}stopWatch(e){e&&(this.removeGameEventListener(e.listener),e.active=!1)}}class u{constructor(e){this.network=n("#network_value"),this.block=n("#block_value"),this.account=n("#account_value"),this.balance=n("#balance_value"),this.title=n(".title_section"),this.title.addEventListener("click",(function(){e.show()}))}update(e){this.network.innerHTML=e.getNetworkName(e.network),this.block.innerHTML=e.latestBlock,e.currentAccount?(this.account.innerHTML=e.currentAccount,this.balance.innerHTML=e.getCurrentBalanceEth()):(this.account.innerHTML="-",this.balance.innerHTML="-")}}class m{constructor(e,t,a){this.faq=n("#footer_faq"),this.tos=n("#footer_tos"),this.play=n("#footer_play"),this.contract=n("#footer_contract"),this.faq.addEventListener("click",(function(){a.show()})),this.tos.addEventListener("click",(function(){t.show()})),this.play.addEventListener("click",(function(){e.show()}))}updateContract(e,t){this.contract.classList.remove("hidden");var a=e+"/address/"+t+"#code";this.contract.setAttribute("href",a)}}class d{constructor(e,t,a){this.id=++d.instanceCount,this.template=n("#game_icon_template"),this.gameElement=this.template.cloneNode(!0),this.gameElement.removeAttribute("id"),this.gameElement.classList.remove("hidden"),this.gameElement.gameIcon=this;var i=this;if(setTimeout((function(){i.gameElement.classList.remove("game_icon_fadeout")}),0),this.labelElement=n(this.gameElement,".game_icon_text_label"),this.hoverElement=n(this.gameElement,".game_icon_text_hover"),this.propBgElement=n(this.gameElement,".game_prop_background"),this.labelElement.innerHTML=e,this.hoverElement.innerHTML=t,a){var s=this.createColorStyle(a);this.gameElement.classList.add(s)}}attachParent(e){e.appendChild(this.gameElement)}detachParent(){this.gameElement.parentNode&&this.gameElement.parentNode.removeChild(this.gameElement)}getWidth(){return e=this.gameElement,t=e.offsetWidth,a=window.getComputedStyle(e),t+=parseInt(a.marginLeft),t+=parseInt(a.marginRight),t+=parseInt(a.borderLeftWidth),t+=parseInt(a.borderRightWidth);var e,t,a}addEventListener(e,t){this.gameElement.addEventListener(e,t)}setLabelText(e){this.labelElement.innerHTML=e}setHoverText(e){this.hoverElement.innerHTML=e}setLeftStyle(e){this.gameElement.style.left=e}setHighlight(e){e?this.gameElement.classList.add("game_icon_highlight"):this.gameElement.classList.remove("game_icon_highlight")}setPropertyBgWidth(e){this.propBgElement.style.width=e}setGameProperty(e,t,a){var i=n(this.gameElement,".game_prop_slot"+e),s=n(i,".game_prop_slot_label"),r=n(i,".game_prop_slot_text");s.innerHTML=t,r.innerHTML=a}fadeOut(){this.gameElement.classList.add("game_icon_fadeout")}createColorStyle(e){var t=e.substring(1),a=".game_color_"+t;if(!n(a)){var i=this.lighten(t),s=document.createElement("style");s.type="text/css",s.innerHTML=a+"{ background: linear-gradient(to bottom, "+e+", "+i+"); }",n("head").appendChild(s)}return a.substring(1)}lighten(e){var t=Number("0x"+(e[0]+e[1])),a=Number("0x"+(e[2]+e[3])),n=Number("0x"+(e[4]+e[5]));return t=Math.min(255,t+32),a=Math.min(255,a+32),n=Math.min(255,n+32),"#"+t.toString(16)+a.toString(16)+n.toString(16)}}d.instanceCount=0;class p{constructor(e,t){var a=n(e);this.listContainer=a,this.gameHeader=n(a,".game_list_header"),this.gameList=n(a,".game_list"),this.gameMap={},this.hideWhenEmpty=t,this.sortPredicate=null,this.lastVisibleSortedGame=null,this.gamePropBgStyle=this.createGamePropBgStyle();var i=this;this.listContainer.addEventListener("transitionend",(function(e){if("top"===e.propertyName){var t=i.listContainer.getBoundingClientRect();t.top!==i.lastTopValue&&(i.lastTopValue=t.top,i.createGamePropBgStyle())}}));var s=n(".content");s.addEventListener("transitionend",(function(e){if("height"===e.propertyName){var t=s.getBoundingClientRect();t.height!==i.lastContentHeight&&(i.lastContentHeight=t.height,i.createGamePropBgStyle())}}))}addGame(e,t,a,n){var i;return(i=this.gameMap[e])&&this.removeGame(e),this.listContainer.classList.remove("game_list_container_hidden"),(i=new d(a,n,t.gameColor)).gameData=t,i.sortable=!0,i.propBgElement.classList.add(this.gamePropBgStyle),i.attachParent(this.gameList),this.gameMap[e]=i,this.sortGames(),i}updateGame(e,t){var a=this.gameMap[e];return a&&(a.gameData=t),a}removeGame(e){var t=this.gameMap[e];t&&(this.removeGameHelper(t),delete this.gameMap[e],this.sortGames(),this.checkHideHeader())}removeAllGames(){for(var e=Object.keys(this.gameMap),t=0;t<e.length;++t){var a=e[t];let n=this.gameMap[a];n&&this.removeGameHelper(n)}this.gameMap={},this.sortGames(),this.checkHideHeader()}removeGameHelper(e){e.remove=!0,e.fadeOut(),e.addEventListener("transitionend",(function(){e.detachParent()}))}checkHideHeader(){this.hideWhenEmpty&&(Object.keys(this.gameMap).length<=0&&this.listContainer.classList.add("game_list_container_hidden"))}sortBy(e){this.sortPredicate=e,this.sortGames()}sortGames(){var e=[],t=this.gameList.children.length;for(let n=0;n<this.gameList.children.length;n++){var a=this.gameList.children[n];a.gameIcon.flowIndex=n,a.gameIcon.sortable&&(t=Math.min(t,n),e.push(a.gameIcon))}if(!(e.length<=0)){var n=this.sortPredicate;e.sort((function(e,t){if(t.remove&&!e.remove)return-1;if(e.remove&&!t.remove)return 1;var a=0;return n&&(a=n(e.gameData,t.gameData)),0===a?t.id-e.id:a}));var i=e[0].getWidth();for(let a=0;a<e.length;++a){var s=e[a],r=i*(t+a)+"px";s.setLeftStyle(r),s.remove||(this.lastVisibleSortedGame=s)}}}createGamePropBgStyle(){var e="game_prop_background_"+this.listContainer.getAttribute("id"),t=n("#"+e);t&&t.parentElement.removeChild(t);var a=this.listContainer.getBoundingClientRect(),i=n(".content").getBoundingClientRect(),s=i.top-a.top+"px",r=a.height+(i.bottom-a.bottom)+"px",o=document.createElement("style");return o.setAttribute("id",e),o.type="text/css",o.innerHTML="."+e+"{ background: linear-gradient(to bottom, rgba(97, 115, 119, 0.9) "+s+", rgba(81, 99, 103, 0.9) "+r+"); }",n("head").appendChild(o),e}}class v extends p{constructor(e,t){super("#open_game_list",!1),this.onCreateClick=null,this.onGameClick=null;var a=this;this.gameFilterButton=n(this.gameHeader,".game_list_header_filter"),this.gameFilterButton.addEventListener("click",(async function(){var n=await e.retrieveBetLimits();t.initSlider(n.min,n.max,n.min);var i=await t.retrieveInput();a.sortByEth(i)})),setTimeout((function(){a.listContainer.classList.remove("game_list_container_hidden")}),33)}addGame(e,t){var a=parseFloat(Math.round(1e3*t.betAmountInEth)/1e3).toFixed(3),n=super.addGame(e,t,a+" ETH","PLAY",t.gameColor);n.setGameProperty(2,"CREATOR",t.player1),n.setGameProperty(3,"WAGER",t.betAmountInEth+" ETH");var i=this;n.addEventListener("click",(function(){i.onGameClick&&i.onGameClick(e,t)}))}sortByEth(e){this.sortBy((function(t,a){var n=t.betAmountInEth.toNumber(),i=a.betAmountInEth.toNumber();return Math.abs(n-e)-Math.abs(i-e)}))}}class w extends p{constructor(e){super("#active_game_list",!0),this.spineth=e,this.onGameClick=null,this.onCancel=null,this.onReveal=null,this.onExpire=null,this.onWithdraw=null}getTimeString(e){var t="";return e>3600&&(t+=Math.floor(e/3600)+"h "),(e%=3600)>60&&(t+=Math.floor(e/60)+"m "),t+=e%60+"s"}determineGameState(e,t){var a=t.state.toNumber(),n={creator:"OPPONENT"};if(t.player1===e&&(n.creator="YOU"),t.player1===e?n.opponent=t.player2:t.player2===e&&(n.opponent=t.player1),a===this.spineth.WAITING_FOR_PLAYERS)n.label="WAIT",n.hover="CANCEL",n.opponent="NONE",n.info="WAITING FOR OPPONENT",n.action=this.onCancel;else if(a===this.spineth.WAITING_FOR_REVEAL){var i=Math.floor(Date.now()/1e3),s=t.expireTime.toNumber()+300-i;t.player1===e?(n.label="REVEAL",n.hover="REVEAL",n.info="REVEAL YOUR BET",n.action=this.onReveal):s<=0?(n.label="EXPIRE",n.hover="EXPIRE",n.info="REVEAL TIME EXPIRED. EXPIRE GAME TO WIN",n.action=this.onExpire):(n.label="WAIT",n.hover=this.getTimeString(s),n.info="WAITING FOR OPPONENT TO REVEAL BET",n.action=null)}else a===this.spineth.COMPLETE&&(n.label="DONE",n.hover="WITH DRAW",n.info="WITHDRAW YOUR EARNINGS",n.action=this.onWithdraw);return n}updateGame(e,t,a){var n=super.updateGame(t,a);this.updateGameState(e,n)}updateGameState(e,t){var a=this.determineGameState(e,t.gameData);t.setLabelText(a.label),t.setHoverText(a.hover),t.setGameProperty(1,"INFO",a.info),t.setGameProperty(2,"OPPONENT",a.opponent),t.setGameProperty(3,"CREATED BY",a.creator),t.setGameProperty(4,"WAGER",t.gameData.betAmountInEth+" ETH"),a.action&&a.action!==this.onCancel?t.setHighlight(!0):t.setHighlight(!1)}addGame(e,t,a){var n=super.addGame(t,a,"","",a.gameColor);this.updateGameState(e,n);var i,s=this;n.addEventListener("click",(function(){var a=s.determineGameState(e,n.gameData);a.action?a.action(t,n.gameData):s.onGameClick&&s.onGameClick(t,n.gameData)})),n.addEventListener("mouseover",(function(){s.updateGameState(e,n),i=setInterval((function(){s.updateGameState(e,n)}),1e3)})),n.addEventListener("mouseout",(function(){clearInterval(i)}))}}class y extends p{constructor(){super("#completed_game_list",!0),this.onGameClick=null}addGame(e,t,a){var n=0,i="";a.player1===e?(n=a.outcome.ethPlayer1,i=a.player2):a.player2===e&&(n=a.outcome.ethPlayer2,i=a.player1);var s=0,r="DRAW";n.toNumber()>a.betAmountInEth.toNumber()?(s=a.outcome.feeEth,r="WON"):n.toNumber()<a.betAmountInEth.toNumber()&&(s=0,r="LOST");var o=super.addGame(t,a,r,r,a.gameColor);o.setGameProperty(1,"OPPONENT",i),o.setGameProperty(2,"WAGER",a.betAmountInEth+" ETH"),o.setGameProperty(3,"PAYOUT",n+" ETH"),o.setGameProperty(4,"FEE PAID",s+" ETH");var c=this;o.addEventListener("click",(function(){c.onGameClick&&c.onGameClick(t,a)}))}}class g extends p{constructor(){super("#recent_game_list",!0),this.onGameClick=null}addGame(e,t){this.gameList.children.length>=16&&this.lastVisibleSortedGame&&this.removeGame(this.lastVisibleSortedGame.gameData.gameId);var a=parseFloat(Math.round(1e3*t.betAmountInEth)/1e3).toFixed(3)+" ETH",n=super.addGame(e,t,a,a,t.gameColor);n.setGameProperty(1,"PLAYER 1",t.player1),n.setGameProperty(2,"PLAYER 2",t.player2),n.setGameProperty(3,"WAGER",t.betAmountInEth+" ETH");var i=this;n.addEventListener("click",(function(){i.onGameClick&&i.onGameClick(e,t)}))}}class f{constructor(e){this.overlay=n(e),this.closeButtons=i(this.overlay,".overlay_close"),this.confirmButton=n(this.overlay,".overlay_confirm"),this.titleText=n(this.overlay,".overlay_title"),this.onConfirm=null,this.onCancel=null;var t=this;if(this.confirmButton&&this.confirmButton.addEventListener("click",(function(){var e=t.onConfirm;e&&(t.close(),e(t.getInput()))})),this.closeButtons)for(let e=0;e<this.closeButtons.length;++e){this.closeButtons[e].addEventListener("click",(function(){var e=t.onCancel;e&&(t.close(),e("cancelled"))}))}}close(){this.overlay.classList.remove("overlay_appear"),this.onConfirm=null,this.onCancel=null}getInput(){}async retrieveInput(){this.overlay.classList.add("overlay_appear");var e=this;return await new Promise((function(t,a){e.onConfirm=t,e.onCancel=a}))}}class E extends f{constructor(e){super("#welcome_overlay"),this.alwaysShow=!1,this.welcomeVersion="welcome_v1.0",this.howToPlayOverlay=e}getInput(){return!0}async show(){try{await this.retrieveInput()&&this.howToPlayOverlay.show()}catch(e){}}async checkShow(){!l.enabled&&window.localStorage.getItem(this.welcomeVersion)||(await this.show(),window.localStorage.setItem(this.welcomeVersion,!0))}}class b extends f{constructor(){super("#tos_overlay"),this.tosVersion="tos_v1.0"}async checkAccept(){!l.enabled&&window.localStorage.getItem(this.tosVersion)||(this.confirmButton.innerHTML="ACCEPT",await this.retrieveInput(),window.localStorage.setItem(this.tosVersion,!0))}async show(){this.confirmButton.innerHTML="CLOSE";try{await this.retrieveInput()}catch(e){}}}class _ extends f{constructor(){super("#faq_overlay")}async show(){try{await this.retrieveInput()}catch(e){}}}class G extends f{constructor(e){super(e),this.value=n(this.overlay,".overlay_value"),this.slider=n(this.overlay,".overlay_slider"),this.messageText=n(this.overlay,".overlay_message");var t=this;this.slider.addEventListener("input",(function(){t.updateSliderValue()})),this.value.contentEditable=!0,this.value.addEventListener("input",(function(){var e=Number(t.value.innerHTML);isNaN(e)?t.value.innerHTML=t.slider.value:e<t.slider.min?t.value.innerHTML=t.slider.min:e>t.slider.max&&(t.value.innerHTML=t.slider.max),t.slider.value=t.value.innerHTML})),this.updateSliderValue()}updateSliderValue(){this.value.innerHTML=this.slider.value}initSlider(e,t,a){this.slider.min=e,this.slider.max=t,this.slider.value=a,this.updateSliderValue()}async retrieveInput(e,t){return e&&(this.titleText.innerHTML=e),t&&(this.messageText.innerHTML=t),super.retrieveInput()}getInput(){return this.slider.value}}class C extends f{constructor(e){super(e),this.wheelContainer=n(this.overlay,".wheel_container"),this.wheelSlices=i(this.overlay,".wheel_slice"),this.selection=null;var t=this;for(let e=0;e<this.wheelSlices.length;++e)this.wheelSlices[e].addEventListener("click",(function(){t.selection=t.wheelSlices[e].children[0].innerHTML,t.selection=Number(t.selection),isNaN(t.selection)||(t.lastSelected&&t.lastSelected.classList.remove("wheel_selected_you"),t.wheelSlices[e].classList.add("wheel_selected_you"),t.wheelContainer.setAttribute("centerContent",t.selection),t.confirmButton&&(t.confirmButton.disabled=!1),t.lastSelected=t.wheelSlices[e])}));this.clearInput()}clearInput(){this.wheelContainer.removeAttribute("centerContent"),this.confirmButton&&(this.confirmButton.disabled=!0);for(let e=0;e<this.wheelSlices.length;++e)this.wheelSlices[e].classList.remove("wheel_selected_you")}getInput(){return this.selection}async retrieveInput(e){return this.clearInput(),this.titleText.innerHTML=e,super.retrieveInput()}}class T extends f{constructor(){super("#howtoplay_overlay"),this.ethInput=new G("#howtoplay_eth_input"),this.ethInput.initSlider(.001,10,5),this.betInput=new C("#howtoplay_bet_input"),this.highlightIcons=[n("#howtoplay_highlight1"),n("#howtoplay_highlight2"),n("#howtoplay_highlight3")]}close(){for(var e=0;e<this.highlightIcons.length;++e)this.highlightIcons[e].classList.remove("game_icon_highlight");super.close()}async show(){for(var e=0;e<this.highlightIcons.length;++e)this.highlightIcons[e].classList.add("game_icon_highlight");try{await this.retrieveInput()}catch(e){}}}class L extends f{constructor(e){super(e),this.text=n(this.overlay,".overlay_text_input");var t=this;this.text.addEventListener("input",(function(){t.confirmButton.disabled=""==t.text.value})),this.overlay.addEventListener("transitionend",(function(e){"opacity"==e.propertyName&&t.text.focus()}))}getInput(){return this.text.value}async retrieveInput(){return this.text.value="",this.confirmButton.disabled=!0,super.retrieveInput()}}class A extends f{constructor(){super("#game_summary_overlay"),this.message=n(this.overlay,"#game_summary_message > .overlay_message"),this.opponent=n(this.overlay,"#game_summary_opponent > div"),this.betAmount=n(this.overlay,"#game_summary_bet > .game_summary_number"),this.earnings=n(this.overlay,"#game_summary_earnings > .game_summary_number"),this.payout=n(this.overlay,"#game_summary_payout > .game_summary_number"),this.fee=n(this.overlay,"#game_summary_fee > .game_summary_number"),this.wheelMarker=n(this.overlay,".overlay_wheel_marker"),this.wheelOuterContainer=n(this.overlay,".wheel_outer_container"),this.wheelContainer=n(this.overlay,".wheel_container"),this.wheelSlices=i(this.wheelContainer,".wheel_slice")}clear(){this.message.innerHTML="",this.opponent.innerHTML="",this.betAmount.innerHTML="",this.earnings.innerHTML="",this.payout.innerHTML="",this.fee.innerHTML="",this.message.parentNode.classList.add("game_summary_hidden"),this.opponent.parentNode.classList.add("game_summary_hidden"),this.betAmount.parentNode.classList.add("game_summary_hidden"),this.earnings.parentNode.classList.add("game_summary_hidden"),this.payout.parentNode.classList.add("game_summary_hidden"),this.fee.parentNode.classList.add("game_summary_hidden"),this.wheelMarker.classList.add("hidden"),this.wheelContainer.classList.remove("wheel_spin"),this.wheelContainer.offsetWidth;for(let e=0;e<this.wheelSlices.length;++e)this.wheelSlices[e].classList.remove("wheel_selected_you"),this.wheelSlices[e].classList.remove("wheel_selected_opponent"),this.wheelSlices[e].classList.remove("wheel_selected_both")}async show(e,t,a){this.clear();var n=t.player1,i=t.player2,s=t.wheelBetPlayer1.toNumber(),r=t.wheelBetPlayer2.toNumber(),o=t.outcome?t.outcome.ethPlayer1:0,c=t.betAmountInEth;if(t.player1===e?n="You":t.player2===e&&(n="You",i=t.player1,s=t.wheelBetPlayer2.toNumber(),r=t.wheelBetPlayer1.toNumber(),o=t.outcome?t.outcome.ethPlayer2:0),t.outcome){if(this.wheelMarker.classList.remove("hidden"),this.wheelSlices[s].classList.add("wheel_selected_you"),this.setWheelNumber(t.wheelResult),a){var l=this;return await new Promise((function(a,n){l.wheelContainer.classList.add("wheel_spin");var i=function(){l.wheelContainer.removeEventListener("animationend",i),l.show(e,t,!1),a()};l.wheelContainer.addEventListener("animationend",i),l.retrieveInput().then((function(){l.wheelContainer.removeEventListener("animationend",i),n("overlay was closed")}))}))}this.wheelSlices[r].classList.add("wheel_selected_opponent"),s===r&&this.wheelSlices[s].classList.add("wheel_selected_both");var h=o.minus(c),u=n+" tied this game",m=0;h.toNumber()>0?(u=n+" won this game",h=h.plus(t.outcome.feeEth),m=-t.outcome.feeEth):h.toNumber()<0&&(u=n+" lost this game");var d=h.dividedBy(c).times(100).toNumber(),p=this.countDecimals(c);p=Math.max(p,this.countDecimals(h)),p=Math.max(p,this.countDecimals(m)),p=Math.max(p,this.countDecimals(o)),this.setField(this.message,u),this.setField(this.opponent,"Against "+i),this.setField(this.betAmount,c.toFixed(p)),this.setField(this.earnings,"("+d+"%) "+h.toFixed(p)),this.setField(this.fee,m.toFixed(p)),this.setField(this.payout,o.toFixed(p))}else this.setField(this.opponent,"Opponent "+i),this.setField(this.betAmount,c),s<this.wheelSlices.length&&(this.wheelSlices[s].classList.add("wheel_selected_you"),this.setField(this.message,"Waiting for opponent to reveal bet"));try{await this.retrieveInput()}catch(e){}}countDecimals(e){var t=(""+e).split(".")[1];return t?t.length:0}setWheelNumber(e){var t=360-360/this.wheelSlices.length*e;this.wheelOuterContainer.style.transform="rotate("+t+"deg)"}setField(e,t){e.parentNode.classList.remove("game_summary_hidden"),e.innerHTML=t}}class M{constructor(){this.statusBarElement=n("#status_bar"),this.dismissButton=n(this.statusBarElement,".status_bar_dismiss"),this.contentElement=n(this.statusBarElement,".status_bar_content"),this.hideDelay=null,this.usingInfura=!1;var e=this;this.dismissButton.addEventListener("click",(function(){e.statusBarElement.classList.remove("status_bar_rolldown")}))}hide(){this.statusBarElement.classList.remove("status_bar_rolldown")}delayedHide(e){var t=this;clearTimeout(this.hideDelay),this.hideDelay=setTimeout((function(){t.hide()}),e)}showElements(e,t){if(this.contentElement.innerHTML="",e.length>0)for(var a=0;a<e.length;++a)this.contentElement.appendChild(e[a]);else this.contentElement.appendChild(e);this.statusBarElement.classList.add("status_bar_rolldown"),t>0&&this.delayedHide(t)}showMessage(e,t){t||(t=5e3);var a=document.createElement("span");a.innerHTML=e,this.showElements(a,t)}showNoAccountMessage(){this.usingInfura?this.showMessage("Ethereum browser integration not detected",5e3):this.showMessage("Your account appears to be locked",5e3)}showTransactionPendingMessage(e,t){var a=document.createElement("a");a.innerHTML="Waiting for transaction to be mined",a.target="_blank";var n=e.getEtherscanURL();n+="/search?q="+t,a.href=n;var i=document.createElement("span");i.classList.add("status_bar_spinner"),this.showElements([a,i],0)}showTransactionCompleteMessage(e,t){var a=document.createElement("a");a.innerHTML="Transaction successfully mined!",a.target="_blank";var n=e.getEtherscanURL();n+="/search?q="+t,a.href=n,this.showElements(a,5e3)}}class I{constructor(){this.statusBar=new M,this.contentMsg=n("#content_msg"),this.howToPlayOverlay=new T,this.welcomeOverlay=new E(this.howToPlayOverlay),this.tosOverlay=new b,this.faqOverlay=new _,this.ethOverlay=new G("#eth_input_overlay"),this.betOverlay=new C("#bet_input_overlay"),this.secretOverlay=new L("#secret_input_overlay"),this.revealOverlay=new L("#reveal_input_overlay"),this.gameFilterOverlay=new G("#game_filter_overlay"),this.gameSummaryOverlay=new A,this.header=new u(this.welcomeOverlay),this.footer=new m(this.howToPlayOverlay,this.tosOverlay,this.faqOverlay),this.lastWaitForTxHash=null,this.ethConnection=null,this.spineth=null,this.onContentMsgFadeout=null}setContentMsg(e){var t=this;this.contentMsg.removeEventListener("transitionend",this.onContentMsgFadeout),this.onContentMsgFadeout=function(a){"opacity"===a.propertyName&&(t.contentMsg.removeEventListener("transitionend",t.onContentMsgFadeout),t.contentMsg.innerHTML="",e&&(t.contentMsg.innerHTML=n(e).innerHTML,t.contentMsg.classList.remove("content_msg_hide")))},this.contentMsg.classList.add("content_msg_hide"),this.contentMsg.addEventListener("transitionend",this.onContentMsgFadeout)}async hideContentMsg(){this.setContentMsg(null);var e=this;return r((function(t){var a=function(n){"opacity"===n.propertyName&&(e.contentMsg.removeEventListener("transitionend",a),t(null,!0))};e.contentMsg.addEventListener("transitionend",a)}))}async start(){this.setContentMsg("#content_msg_connecting");var e=null;void 0===window.web3?(e=window.ZeroClientProvider({static:{eth_syncing:!1,web3_clientVersion:"ZeroClientProvider"},pollingInterval:30,rpcUrl:"https://mainnet.infura.io/v3/bcb1ce0fc7c34c6d9c68563936b91939",getAccounts:e=>e(null,[])}),this.statusBar.usingInfura=!0):e=window.web3.currentProvider,window.web3=new window.Web3(e);var t,a=new c;s((async function(){for(;;){var e=a.network;e?(await a.waitForChange(["network"]),e!==a.network&&document.location.reload()):await a.waitForChange(["network"])}}));try{await a.waitForChange(["network","latestBlock"]),t=a.network}catch(e){return void this.setContentMsg("#content_msg_noconnect")}var n=new h(t);n.isValid()?(await this.hideContentMsg(),this.init(a,n),this.run()):this.setContentMsg("#content_msg_nonetwork")}init(e,t){this.ethConnection=e,this.spineth=t,this.openGameList=new v(this.spineth,this.gameFilterOverlay),this.activeGameList=new w(this.spineth),this.completedGameList=new y,this.recentGameList=new g,this.footer.updateContract(this.ethConnection.getEtherscanURL(),this.spineth.address);var a=this;this.footer.onClickDonation=async function(t){if(e.currentAccount){a.ethOverlay.initSlider(.001,.01,.001);var n=await a.ethOverlay.retrieveInput("DONATE","All donations are greatly appreciated"),i=window.web3.toWei(n,"ether");window.web3.eth.sendTransaction({to:t,value:i},(function(){}))}else a.statusBar.showNoAccountMessage()}}run(){var e=this.ethConnection,t=this.spineth,a=this.header,i=this.openGameList,r=this.activeGameList,o=this.completedGameList,c=this.recentGameList,l=this.tosOverlay,h=this.ethOverlay,u=this.betOverlay,m=this.gameSummaryOverlay,d=this.statusBar,p=this;n("#content_main").classList.remove("hidden"),this.welcomeOverlay.checkShow(),s((async function(){for(;;)a.update(e),await e.waitForChange()})),s((async function(){for(var a=null;;)t.stopWatch(a),i.removeAllGames(),a=t.watchOpenGames(e.latestBlock,(function(a,n,s){switch(a){case t.GAME_ADDED:s.player1!==e.currentAccount&&i.addGame(n,s);break;case t.GAME_REMOVED:i.removeGame(n)}})),await e.waitForChange(["currentAccount"])})),s((async function(){for(var a=null;;)t.stopWatch(a),r.removeAllGames(),a=t.watchActiveGames(e.currentAccount,e.latestBlock,(function(a,n,i){switch(a){case t.GAME_ADDED:r.addGame(e.currentAccount,n,i);break;case t.GAME_UPDATED:r.updateGame(e.currentAccount,n,i);break;case t.GAME_REMOVED:r.removeGame(n)}})),await e.waitForChange(["currentAccount"])})),s((async function(){for(var a=null;;)t.stopWatch(a),o.removeAllGames(),a=t.watchCompletedGames(e.currentAccount,e.latestBlock,(function(t,a,n){o.addGame(e.currentAccount,a,n)})),await e.waitForChange(["currentAccount"])})),s((async function(){for(var a=null;;){t.stopWatch(a),c.removeAllGames();var n=t.blockCreated;a=t.watchRecentGames(n,(function(t,a,n){n.player1!==e.currentAccount&&n.player2!==e.currentAccount&&c.addGame(a,n)})),await e.waitForChange(["currentAccount"])}})),c.onGameClick=function(e,t){m.show(null,t)},o.onGameClick=function(t,a){m.show(e.currentAccount,a)},r.onGameClick=function(t,a){m.show(e.currentAccount,a)},i.onCreateClick=async function(){if(e.currentAccount){await l.checkAccept();var a=await t.retrieveBetLimits(),n=e.getCurrentBalanceEth();if(Number(n)<Number(a.min))d.showMessage("You need at least "+a.min+" eth to play");else{Number(n)<Number(a.max)&&(a.max=n),h.initSlider(a.min,a.max,a.min);var i=await h.retrieveInput("CREATE GAME","How much would you like to wager?"),s=await u.retrieveInput("CREATE GAME");try{var r=await t.createGame(e.currentAccount,i,s,(async function(){return p.secretOverlay.retrieveInput()}));p.waitForTransaction(r)}catch(e){d.showMessage(e)}}}else d.showNoAccountMessage()},i.onGameClick=async function(a,n){if(e.currentAccount){await l.checkAccept();var i=e.getCurrentBalanceEth();if(Number(i)<Number(n.betAmountInEth))d.showMessage("You need at least "+n.betAmountInEth+" eth to join this game");else{var s=await u.retrieveInput("JOIN GAME");try{var r=await t.joinGame(e.currentAccount,a,s);p.waitForTransaction(r)}catch(e){d.showMessage(e)}}}else d.showNoAccountMessage()},r.onCancel=async function(a){try{var n=await t.cancelGame(e.currentAccount,a);p.waitForTransaction(n)}catch(e){d.showMessage(e)}},r.onExpire=async function(a){try{var n=await t.expireGame(e.currentAccount,a);p.waitForTransaction(n)}catch(e){d.showMessage(e)}},r.onReveal=async function(a){try{var n=await t.revealBet(e.currentAccount,a,(async function(){return p.revealOverlay.retrieveInput()}));p.waitForTransaction(n)}catch(e){d.showMessage(e)}},r.onWithdraw=async function(a,n){await m.show(e.currentAccount,n,!0);try{var i=await t.withdrawEarnings(e.currentAccount,a);p.waitForTransaction(i)}catch(e){d.showMessage(e)}}}async waitForTransaction(e){for(this.lastWaitForTxHash=e,this.statusBar.showTransactionPendingMessage(this.ethConnection,e);await o(1e3),this.lastWaitForTxHash===e;)try{await this.ethConnection.waitForTransaction(e),this.statusBar.showTransactionCompleteMessage(this.ethConnection,e);break}catch(e){this.statusBar.showMessage(e);break}}}window.addEventListener("load",(function(){(new I).start()}))}]);